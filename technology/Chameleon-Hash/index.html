<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="绘素"><meta name="copyright" content="绘素"><meta name="generator" content="Hexo 6.3.0"><meta name="theme" content="hexo-theme-yun"><title>变色龙哈希（chameleon hash） | 绘素のBlog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><link rel="stylesheet" type="text/css" href="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.css"><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><script defer src="https://fastly.jsdelivr.net/npm/katex@latest/dist/contrib/auto-render.min.js"></script><script type="module">import { renderKatex } from '/js/utils.js'
document.addEventListener("DOMContentLoaded", () => {
  renderKatex({
    ...{},
    ...undefined?.options,
  });
});</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"huisudesu.com","root":"/","title":["绘","素","の","Blog"],"version":"1.10.9","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="变色龙哈希（chameleon hash）简介及实例">
<meta property="og:type" content="article">
<meta property="og:title" content="变色龙哈希（chameleon hash）">
<meta property="og:url" content="https://huisudesu.com/technology/Chameleon-Hash/index.html">
<meta property="og:site_name" content="绘素のBlog">
<meta property="og:description" content="变色龙哈希（chameleon hash）简介及实例">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-12-20T00:00:00.000Z">
<meta property="article:modified_time" content="2023-01-07T14:16:02.323Z">
<meta property="article:author" content="绘素">
<meta property="article:tag" content="哈希函数">
<meta property="article:tag" content="变色龙哈希">
<meta name="twitter:card" content="summary"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="绘素"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="绘素"></a><div class="site-author-name"><a href="/about/">绘素</a></div><span class="site-name">绘素のBlog</span><sub class="site-subtitle"></sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">14</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">7</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">22</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://twitter.com/huisudesu/" title="Twitter"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:twitter-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E8%89%B2%E9%BE%99%E5%93%88%E5%B8%8C%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">变色龙哈希简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">2.</span> <span class="toc-text">前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%EF%BC%88Bilinear-Mapping%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">双线性映射（Bilinear Mapping）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E5%A4%9A%E9%A1%B9%E5%BC%8F%EF%BC%88Lagrange-polynomial%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">拉格朗日多项式（Lagrange polynomial）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gap-Diffie-Hellman-GDP-Group"><span class="toc-number">2.3.</span> <span class="toc-text">Gap Diffie-Hellman (GDP) Group</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E8%89%B2%E9%BE%99%E5%93%88%E5%B8%8C"><span class="toc-number">3.</span> <span class="toc-text">变色龙哈希</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%88%E5%80%BC%E5%8F%98%E8%89%B2%E9%BE%99%E5%93%88%E5%B8%8C"><span class="toc-number">4.</span> <span class="toc-text">阈值变色龙哈希</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">4.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.2.</span> <span class="toc-text">实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%81%E6%98%8E"><span class="toc-number">4.3.</span> <span class="toc-text">证明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96%E5%8F%98%E8%89%B2%E9%BE%99%E5%93%88%E5%B8%8C"><span class="toc-number">5.</span> <span class="toc-text">去中心化变色龙哈希</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="toc-number">5.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0-1"><span class="toc-number">5.2.</span> <span class="toc-text">实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">6.</span> <span class="toc-text">参考</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="https://huisudesu.com/technology/Chameleon-Hash/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="绘素"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="绘素のBlog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">变色龙哈希（chameleon hash）</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2022-12-20 00:00:00" itemprop="dateCreated datePublished" datetime="2022-12-20T00:00:00+00:00">2022-12-20</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E7%A0%94%E7%A9%B6/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">研究</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">哈希函数</span></a><a class="tag-item" href="/tags/%E5%8F%98%E8%89%B2%E9%BE%99%E5%93%88%E5%B8%8C/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">变色龙哈希</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h2 id="变色龙哈希简介"><a href="#变色龙哈希简介" class="headerlink" title="变色龙哈希简介"></a>变色龙哈希简介</h2><p>在介绍变色龙哈希之前，先介绍陷门（Trapdoor）函数。单向陷门函数 $f$ 是具有以下性质的一类函数：</p>
<ul>
<li><p>对于定义域 $D$ 中的任意元素 $x$ ，可在多项式时间内计算得到 $f(x)$</p>
</li>
<li><p>对于值域 $R$ 中的任意元素 $y$ ，无法在多项式时间内计算得到$f^{-1}(x)$</p>
</li>
<li><p>当知道某个信息 $k$ 以后，对于值域 $R$ 中的任意元素 $y$ ，都可以在多项式时间内计算得到 $f_{k}^{-1}(x)$</p>
</li>
</ul>
<p>我们称信息 $k$ 为这个单向陷门函数的<strong>陷门（Trapdoor）</strong>。</p>
<p><strong>变色龙哈希函数（Chameleon Hash  Function）</strong>就是一种<strong>带陷门的哈希函数，</strong>如果<strong>陷门信息已知</strong>，则可以高效地计算出任意输入数据的碰撞。如果<strong>陷门信息未知</strong>，那么变色龙哈希函数和普通的哈希函数一样具有<strong>抗碰撞性</strong>。</p>
<p>一个变色龙函数由下面<strong>四个函数</strong>组成：</p>
<ul>
<li><p>$Setup(1^{\lambda})\rightarrow(hk,td).$ 给定安全参数 $\lambda$ ，密钥生成算法输出公钥 $hk$ 和陷门 $td$ </p>
</li>
<li><p>$Hash(hk,m)\rightarrow (h,r)\Rightarrow Hash(hk,m,r)\rightarrow h.$ 给定公钥 $hk$ ，待哈希的消息 $m$ 和辅助随机数 $r$ ，哈希算法输出哈希值 $h$</p>
</li>
<li><p>$Trap(td,m,r,m’)\rightarrow r’.$ 给定陷门 $td$ ，消息 $m$ ，随机数 $r$ 和另外一个消息 $m’$ ，变色龙算法输出满足$Hash(m,r)&#x3D;Hash(m’,r’)$  的 $r’$ ，并且 $r’$ 是在随机数空间均匀分布的</p>
</li>
<li><p>$Verify(hk,m,h,r)\rightarrow {0,1}$ 验证函数，输出True or False</p>
</li>
</ul>
<blockquote>
<p>除了<strong>不可伪造性</strong>以外，变色龙签名具有比较有趣的性质。我们假定 Bob 掌握一个变色龙哈希算法 的陷门信息，而 Alice 签名的前置哈希算法就是该算法 。当 Alice 签名以后，Bob 如果拿着 Alice 的签名结果给第三方 Charlie 看，第三方必然不会相信这个签名结果，因为 Charlie 知道 Bob 拿有哈希算法的陷门信息，他可以任意更改被签名的消息。即，Bob 不能将 Alice 签名的合法性向第三方展示。这是变色龙签名的<strong>不可传递性</strong>（non-transferability）。另外，Alice 也由于没有陷门信息，不能找到哈希碰撞，从而不能否认其已经签过名，这就是<strong>不可抵赖性</strong>（non-repudiation）。[1]</p>
</blockquote>
<p>在区块链中，如果将连接区块链的哈希函数改为变色龙哈希函数，陷门信息由<strong>特定人</strong>掌握，则这些特定人就可以任意修改区块数据，而不会破坏链式结构的完整性。这给区块链带来了<strong>可编辑</strong>的特性。[1]</p>
<p>下面介绍一些前置知识和变色龙哈希的实例。</p>
<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><h3 id="双线性映射（Bilinear-Mapping）"><a href="#双线性映射（Bilinear-Mapping）" class="headerlink" title="双线性映射（Bilinear Mapping）"></a>双线性映射（Bilinear Mapping）</h3><p>$(G_1, G_2, G_T)$ 是三个素数 $p$ 阶群乘法循环群，双线性映射 $e:G_1\times G_2\rightarrow G_T$ 是满足如下性质的映射：</p>
<ul>
<li><p>双线性：对于 $\forall g_1\in G_1,g_2\in G_2,a,b\in Z_p$，均有$e(g_1^a,g_2^b)&#x3D;e(g_1,g_2)^{ab}$成立</p>
</li>
<li><p>非退化性：$\exist g_1\in G_1, g_2\in G_2$满足$e(g_1,g_2)\not&#x3D;1_{G_T}$</p>
</li>
<li><p>可计算性：存在有效的算法，对于$\forall g_1\in G_1, g_2\in G_2$，均可计算$e(g_1,g_2)$</p>
</li>
</ul>
<p>如果$G_1&#x3D;G_2$ 则称上述双线性配对是对称的，否则是非对称的。</p>
<h3 id="拉格朗日多项式（Lagrange-polynomial）"><a href="#拉格朗日多项式（Lagrange-polynomial）" class="headerlink" title="拉格朗日多项式（Lagrange polynomial）"></a>拉格朗日多项式（Lagrange polynomial）</h3><p>对于某个多项式函数，已知有给定的$k+1$个取值点： $(x_0,y_0).\dots,(x_k,y_k)$ ，其中，$x_j$对应自变量，$y_i$对于函数取值，假设任意$x_j$都互不相同。</p>
<p><strong>拉格朗日插值多项式</strong>为：$L(x):&#x3D;\sum_{j&#x3D;0}^{k}y_jl_j(x)$</p>
<p>其中，$l_j(x)$ 为<strong>拉格朗日基本多项式</strong>（或称<strong>插值基函数，</strong>Lagrange basis polynomials），其表达式为： $l_j(x):&#x3D;\Pi_{i&#x3D;0,i\not&#x3D;j}^k\frac{x-x_i}{x_j-x_i}$</p>
<p>拉格朗日基本多项式$l <em>{j}(x)$的特点是在 $x</em>{j}$上取值为<strong>1</strong>，在其它的点 $x_{i},,i\neq j$上取值为<strong>0</strong>。</p>
<h3 id="Gap-Diffie-Hellman-GDP-Group"><a href="#Gap-Diffie-Hellman-GDP-Group" class="headerlink" title="Gap Diffie-Hellman (GDP) Group"></a>Gap Diffie-Hellman (GDP) Group</h3><p>设 $G$ 是一个素数 $p$ 阶的乘法循环群，生成元为 $g$。</p>
<p>对于 <em>Diffie-Hellman tuple</em>: $(g,g^x,g^y,g^{xy})$ ，其中，$x,y\in Z_p^*$，有如下两个问题：</p>
<ul>
<li><p>Computational Diffie-Hellman (CDH) problem</p>
<ul>
<li>给定 $(g,g^x,g^y)$ ，其中，$x,y\in Z_p^*$ ，计算 $g^{xy}$</li>
</ul>
</li>
<li><p>Decisional Diffie-Hellman (DDH) problem</p>
<ul>
<li>给定 $(g,g^x,g^y,g^{z})$ ，其中，$x,y,z\in Z_p^*$，确定 $g^{xy}&#x3D;g^z$ 是否成立</li>
</ul>
</li>
</ul>
<p><strong>Gap Diffie-Hellman (GDH) group</strong> 是满足如下性质的 group：</p>
<ul>
<li><p>Decisional Diffie-Hellman (DDH) problem 可在多项式时间内解决</p>
</li>
<li><p>Computational Diffie-Hellman (CDH) problem 没有多项式时间算法以不可忽略的概率解决</p>
</li>
</ul>
<h2 id="变色龙哈希"><a href="#变色龙哈希" class="headerlink" title="变色龙哈希"></a>变色龙哈希</h2><p>Public Coin Chameleon Hash[2] 是一个变色龙哈希的实现，函数的具体实现如下：</p>
<ul>
<li><p>$Setup(1^\lambda)\rightarrow (G_1,G_2,p,g_1,g_2)$</p>
<ul>
<li><p>生成素数 $p$ 阶双线性群 $(G_1, G_2, G_T)$</p>
</li>
<li><p>$G_1&#x3D;\langle g_1\rangle, G_2&#x3D;\langle g_2\rangle$ 生成元</p>
</li>
<li><p>系统参数：$params&#x3D;(G_1,G_2,p,g_1,g_2)$</p>
</li>
</ul>
</li>
<li><p>$KeyGen(params)\rightarrow (hk,tk)$</p>
<ul>
<li><p>生成 $x\xleftarrow{R}Z_p, \widehat{h}\xleftarrow{R} G_1$</p>
</li>
<li><p>$h_1&#x3D;g^x_1, h_2&#x3D;g^x_2$</p>
</li>
<li><p>$hk&#x3D;(h_1,h_2,\widehat{h})$</p>
</li>
<li><p>$tk&#x3D;x$</p>
</li>
</ul>
</li>
<li><p>$Hash(m,hk)\rightarrow (\hslash,R)$</p>
<ul>
<li><p>随机数 $r\xleftarrow{R}Z_p$</p>
</li>
<li><p>$\hslash&#x3D;h_1^r\widehat{h}^m$</p>
</li>
<li><p>$R&#x3D;g_1^r$</p>
</li>
</ul>
</li>
<li><p>$HVerify(m,hk,R)$</p>
<ul>
<li><p>$true$ if $e(\hslash&#x2F;\widehat{h}^m,g_2)&#x3D;e(R,h_2)$</p>
<ul>
<li><p>$\Leftrightarrow e(h_1^r,g_2)&#x3D;e(g_1^r,h_2)$</p>
</li>
<li><p>$\Leftrightarrow e(g_1^{xr},g_2)&#x3D;e(g_1^r,g_2^x)$</p>
</li>
<li><p>$\Leftrightarrow e(g_1,g_2)^{xr}&#x3D;e(g_1,g_2)^{xr}$</p>
</li>
</ul>
</li>
<li><p>$false$ otherwise</p>
</li>
</ul>
</li>
<li><p>$Hcol(tk,m,m’)$</p>
<ul>
<li><p>新message $m’$ ，计算新的 $R’$</p>
</li>
<li><p>$R’&#x3D;(\frac{\hslash}{\widehat{h}^{m’}})^{\frac{1}{x}}$</p>
</li>
<li><p>$e(\hslash&#x2F;\widehat{h}^{m’},g_2)&#x3D;e(R’,h_2)$</p>
</li>
<li><p>$\Leftrightarrow e(\hslash&#x2F;\widehat{h}^{m’},g_2)&#x3D;e((\hslash&#x2F;\widehat{h}^{m’})^{1&#x2F;x},g_2^x)$</p>
</li>
<li><p>$\Leftrightarrow e(\hslash&#x2F;\widehat{h}^{m’},g_2)&#x3D;e(\hslash&#x2F;\widehat{h}^{m’},g_2)$</p>
</li>
</ul>
</li>
</ul>
<p>&amp;nbsp;</p>
<h2 id="阈值变色龙哈希"><a href="#阈值变色龙哈希" class="headerlink" title="阈值变色龙哈希"></a>阈值变色龙哈希</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>阈值变色龙哈希（Threshold Trapdoor Chameleon Hash）[3]是一个将变色龙哈希应用到去中心化领域的尝试，使用拉格朗日多项式实现去中心化。但是仍然需要一个信任实体分发密钥。</p>
<p>其总体思想如下：</p>
<ul>
<li><p>$t$ 个节点，共享一个 $t-1$ 次的多项式 $f$</p>
</li>
<li><p>每个节点的私钥为该多项式在点 $i$ 的值 $f(i)$</p>
</li>
<li><p>$t$ 个点 $(i,f(i))$ 可以推出原多项式</p>
</li>
<li><p>Trapdoor 是这个 $t-1$ 次的多项式在 $0$ 点的值</p>
</li>
</ul>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><ul>
<li><p>$Setup(1^\lambda)\rightarrow (G_1,G_2,p,g_1,g_2)$</p>
<ul>
<li><p>生成素数 $p$ 阶双线性群 $(G_1, G_2, G_T)$</p>
</li>
<li><p>$G_1&#x3D;\langle g_1\rangle, G_2&#x3D;\langle g_2\rangle$， $g_1,g_2$ 为生成元</p>
</li>
<li><p>系统参数：$params&#x3D;(G_1,G_2,p,g_1,g_2)$</p>
</li>
</ul>
</li>
<li><p>$KeyGen(params,t,n)\rightarrow (hk,(sk_1,\dots,sk_n))$</p>
<ul>
<li><p>生成$x\xleftarrow{R}Z_p, \widehat{h}\xleftarrow{R} G_1$</p>
</li>
<li><p>$h_1&#x3D;g^x_1, h_2&#x3D;g^x_2$</p>
</li>
<li><p>计算$d\ s.t.\ xd \equiv  1\bmod{p}$</p>
</li>
<li><p>生成系数在$Z_p$中的$t-1$次的多项式$v$，将$v$的常数项设置为$d$，即$v(0)&#x3D;d$</p>
<ul>
<li>$v(x)&#x3D;d+\alpha_{1}x^{1}+\alpha_{2}x^{2}+\cdots+\alpha_{t-1}x^{t-1},\ \alpha_i\in Z_p$</li>
</ul>
</li>
<li><p>public hash key: $hk&#x3D;(h_1,h_2,\widehat{h})$</p>
</li>
<li><p>每个node $i\in[1,n]$ 的私钥$sk_i&#x3D;v(i)$</p>
<ul>
<li>$v(i)&#x3D;(\sum_{j&#x3D;1}^{t-1}i^{j}\alpha_j) +d$</li>
</ul>
</li>
</ul>
</li>
<li><p>$Hash(m,hk)\rightarrow (\hslash,R)$</p>
<ul>
<li><p>随机数$r\xleftarrow{R}Z_p$</p>
</li>
<li><p>$\hslash&#x3D;h_1^r\widehat{h}^m$</p>
</li>
<li><p>$R&#x3D;g_1^r$</p>
</li>
</ul>
</li>
<li><p>$HVerify(m,\hslash, hk,R)\rightarrow (true\ or\ false)$</p>
<ul>
<li><p>$true$ if $e(\hslash&#x2F;\widehat{h}^m,g_2)&#x3D;e(R,h_2)$</p>
</li>
<li><p>$false$ otherwise</p>
</li>
</ul>
</li>
<li><p>$Sign(sk_i,m’,\hslash)\rightarrow(\sigma_i)$</p>
<ul>
<li><p>node $i$ 签名作为新消息 $m’$ 的凭证</p>
</li>
<li><p>$\sigma_i&#x3D;(\frac{\hslash}{\widehat{h}^{m’}})^{sk_i}$</p>
</li>
</ul>
</li>
<li><p>$Hcol((\sigma_1,\dots,\sigma_t),R,hk,\hslash,m)\rightarrow(\bot\ or\ R’)$</p>
<ul>
<li><p>先运行 $HVerify$ 检查，如果$false$返回$\bot$</p>
</li>
<li><p>对每个node $i$，计算拉格朗日系数$l$</p>
</li>
<li><p>$l_i&#x3D;\big[\Pi_{j&#x3D;1,j\not&#x3D;i}^{t}(0-j)\big]\big[\Pi_{j&#x3D;1,j\not&#x3D;i}^{t}(i-j)\big]^{-1}\bmod{p}$</p>
</li>
<li><p>计算新的随机数$R’&#x3D;\Pi_{i&#x3D;1}^{t} \sigma_i^{l_i}$</p>
<ul>
<li>$R’&#x3D;\Pi_{i&#x3D;1}^{t} \sigma_i^{l_i}&#x3D;\Pi_{i&#x3D;1}^{t} ((\frac{\hslash}{\widehat{h}^{m’}})^{sk_i})^{l_i}&#x3D;\Pi_{i&#x3D;1}^{t} (\frac{\hslash}{\widehat{h}^{m’}})^{sk_il_i}&#x3D;(\frac{\hslash}{\widehat{h}^{m’}})^{\sum_{i&#x3D;1}^{t}sk_il_i}&#x3D;(\frac{\hslash}{\widehat{h}^{m’}})^{\sum_{i&#x3D;1}^{t}v(i)l_i}$</li>
</ul>
</li>
<li><p>检查$e(\hslash&#x2F;\widehat{h}^{m’},g_2)&#x3D;e(R’,h_2)$</p>
<ul>
<li><p>$\Leftrightarrow e(\hslash&#x2F;\widehat{h}^{m’},g_2)&#x3D;e((\frac{\hslash}{\widehat{h}^{m’}})^{\sum_{i&#x3D;1}^{t}v(i)l_i},g_2^x)$</p>
</li>
<li><p>$\Leftrightarrow e(\hslash&#x2F;\widehat{h}^{m’},g_2)&#x3D;e((\frac{\hslash}{\widehat{h}^{m’}}),g_2)^{x\sum_{i&#x3D;1}^{t}v(i)l_i}$</p>
</li>
<li><p>$\Leftrightarrow e(\hslash&#x2F;\widehat{h}^{m’},g_2)&#x3D;e((\frac{\hslash}{\widehat{h}^{m’}}),g_2^{x\sum_{i&#x3D;1}^{t}v(i)l_i})$</p>
</li>
<li><p>$\Leftrightarrow x\sum_{i&#x3D;1}^{t}v(i)l_i\equiv1\bmod{p}$</p>
</li>
<li><p>又$xd\equiv 1\bmod{p}$ ？证明过程见下一部分。</p>
</li>
</ul>
</li>
<li><p>等式成立，返回$R’$，否则，返回$\bot$</p>
</li>
</ul>
</li>
</ul>
<h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p>要证$x\sum_{i&#x3D;1}^{t}v(i)\ell_i\equiv1\bmod{p}$</p>
<p>已知</p>
<ul>
<li><p>$\ell_i&#x3D;\big[\Pi_{j&#x3D;1,j\not&#x3D;i}^{t}(0-j)\big]\big[\Pi_{j&#x3D;1,j\not&#x3D;i}^{t}(i-j)\big]^{-1}\bmod{p}$</p>
</li>
<li><p>$xd\equiv1\bmod{p}$</p>
</li>
</ul>
<p>有一系列点$(i,v(i)),i\in[1,t]$（$t$ 个取值点），其拉格朗日多项式为：</p>
<p>$L(x)&#x3D;\sum_{i&#x3D;1}^tv(i)l_i(x)$ （$t-1$ 次多项式）</p>
<p>$l_i(x):&#x3D;\Pi_{j&#x3D;1,j\not&#x3D;i}^t\frac{x-x_j}{x_i-x_j}&#x3D;\Pi_{j&#x3D;1,j\not&#x3D;i}^t\frac{x-j}{i-j}$</p>
<p>$l_i(0)&#x3D;\Pi_{j&#x3D;1,j\not&#x3D;i}^t\frac{0-j}{i-j}&#x3D;\ell_i$</p>
<p>$x&#x3D;i$ 时，取值为1，否则，为0</p>
<p>故$L(0)&#x3D;\sum_{i&#x3D;1}^tv(i)l_i(0)&#x3D;\sum_{i&#x3D;1}^tv(i)\ell_i$</p>
<p>因为这 $t$ 个点是在原函数上的</p>
<p>因为拉格朗日多项式的存在性和唯一性，可以确定该多项式为KeyGen中的多项式。</p>
<ul>
<li><p>存在性：对于给定的$t$个点，必存在拉格朗日多项式$l_i(x):&#x3D;\Pi_{j&#x3D;1,j\not&#x3D;i}^t\frac{x-x_j}{x_i-x_j}$</p>
</li>
<li><p>唯一性：次数不超过$t-1$的拉格朗日多项式至多只有一个</p>
</li>
</ul>
<p>故$L(0)&#x3D;d$</p>
<p>故$x\sum_{i&#x3D;1}^{t}v(i)\ell_i\equiv xL(0)\equiv xd\equiv 1\bmod{p}$</p>
<h2 id="去中心化变色龙哈希"><a href="#去中心化变色龙哈希" class="headerlink" title="去中心化变色龙哈希"></a>去中心化变色龙哈希</h2><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><p>去中心化变色龙哈希（Decentralized Chameleon Hash）[4]是一种完全去中心化的变色龙哈希。其基本思想如下：</p>
<ul>
<li><p>$t$ 个节点，每个节点都有一个 $t-1$ 次的多项式 $f_i$。</p>
</li>
<li><p>这 $t$ 个 $t-1$ 次的多项式的和是一个新的多项式 $f$。</p>
</li>
<li><p>每个节点的私钥为 $\sum f_i(i)&#x3D;f(i)$。</p>
</li>
<li><p>$t$ 个点 $(i,f(i))$ 可以推出原多项式。</p>
</li>
<li><p>Trapdoor 就是这个新的多项式 $f$ 在 $0$ 点的值。</p>
</li>
</ul>
<h3 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h3><p>设 $G$ 是一个素数 $p$ （取决于系统安全参数 $\lambda$）阶的 GDH 群</p>
<p>$g$ 是 $G$ 的生成元</p>
<p>$$ID:{0,1}^<em>\rightarrow Z_p^</em>$$</p>
<ul>
<li><p>Key generation</p>
<ul>
<li><p>输入安全参数 $\lambda$ 和参与者人数 $t$ </p>
</li>
<li><p>参与者 $P_i\ (i\in {1,\dots,t})$ 执行如下操作</p>
<ul>
<li><p>选择一个 $t-1$ 次的多项式 $f_i(x)&#x3D;\sum_{j&#x3D;0}^{t-1}a_{i,j}x^j$</p>
<ul>
<li>其中，$a_{i,0},\dots,a_{i,t-1}\in Z_p^*$ 是随机的系数</li>
</ul>
</li>
<li><p>将 $(f_i(ID(P_j)),(g^{f_i(ID(P_1))},\dots,g^{f_i(ID(P_t))}),g^{a_{i,0}})$ 发送到 $P_j\ (i\in{1,\dots,t}\backslash i)$</p>
</li>
<li><p>当收到 $P_j$ 的消息 $(f_j(ID(P_i)),(g^{f_j(ID(P_1))},\dots,g^{f_j(ID(P_t))}),g^{a_{j,0}})$ 后</p>
<ul>
<li><p>检查 $(g,f_j(ID(P_i)),g^{f_j(ID(P_i))})$ 是否正确</p>
</li>
<li><p>检查 $\Pi_{k&#x3D;1}^t g^{\lambda_k\cdot f_j(ID(P_k))}&#x3D;g^{a_j,0}$ 是否成立</p>
<ul>
<li>其中，$\lambda_k&#x3D;\Pi_{j&#x3D;1,j\not&#x3D;k}^t\frac{ID(P_j)}{ID(P_j)-ID(P_k)}$ </li>
<li>拉格朗日多项式（Lagrange polynomial）在 $0$ 点的情况，用来保证 $t + 1$个点在一个 $t-1$ 次的多项式上，即后两个数据正确</li>
</ul>
</li>
</ul>
</li>
<li><p>输出</p>
<ul>
<li><p>公钥 $g^s\leftarrow \Pi_{j&#x3D;1}^tg^{a_j,0}$</p>
<ul>
<li>其中，$s&#x3D;\sum_{j&#x3D;1}^t a_{j,0}$</li>
</ul>
</li>
<li><p>私钥 $s_i\leftarrow \sum_{j&#x3D;1}^t f_j(ID(P_i))&#x3D;f(ID(P_i))$</p>
<ul>
<li>其中，$f(x)&#x3D;\sum_{j&#x3D;1}^tf_j(x)$</li>
<li>点 $ID(P_i)$ 在 $t$ 个 $t-1$ 次多项式上的值的和，即点 $ID(P_i)$ 在新的多项式上的值</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Hashing</p>
<ul>
<li><p>输入公钥 $g^s$ 和消息 $m\in{0,1}^*$</p>
</li>
<li><p>先计算 $u\leftarrow H(g^s,m)$</p>
<ul>
<li>其中， $H:G\times{0,1}^*\rightarrow G$ 是一个加密哈希函数</li>
</ul>
</li>
<li><p>选择随机整数 $e\in Z_p^*$</p>
</li>
<li><p>输出</p>
<ul>
<li><p>随机数 $r&#x3D;(g^e,g^{se})$</p>
</li>
<li><p>哈希 $h\leftarrow g^eu^m$</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Rehashing</p>
<ul>
<li><p>输入公钥 $g^s$ 和原消息-随机数对 $(m,r&#x3D;(g^e,g^{se}))$</p>
</li>
<li><p>计算 $u\leftarrow H(g^s,m)$</p>
</li>
<li><p>输出哈希 $h\leftarrow g^eu^m$</p>
</li>
</ul>
</li>
<li><p>Adaptation</p>
<ul>
<li><p>输入私钥 $s_i$ 、公钥 $g^s$ 、消息-随机数对 $(m,r&#x3D;(g^e,g^{se}))$ 和新消息$m’\in{0,1}^*$</p>
</li>
<li><p>参与者 $P_i\ (i\in{1,\dots,t})$ 执行：</p>
<ul>
<li><p>计算 $g^{e’}\leftarrow g^eu^{m-m’}$</p>
<ul>
<li>其中， $u\leftarrow H(g^s,m)$</li>
</ul>
</li>
<li><p>计算 $\eta_i\leftarrow (g^{e’})^{\lambda_i\cdot s_i}$ 并发送到 $P_j\ (i\in{1,\dots,t}\backslash i)$</p>
<ul>
<li>其中， $\lambda_i&#x3D;\Pi_{j&#x3D;1,j\not&#x3D;i}^t\frac{ID(P_j)}{ID(P_j)-ID(P_i)}$</li>
</ul>
</li>
<li><p>收到 $(\eta_1,\dots,\eta_{i-1},\eta_{i+1},\dots,\eta_t)$ 后，计算 $g^{se’}\leftarrow \Pi_{j&#x3D;1}^t\eta_j$</p>
</li>
<li><p>输出新的随机数$r’&#x3D;(g^{e’},g^{se’})$</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Verification</p>
<ul>
<li><p>输入公钥 $pk$ 、消息-随机数对 $(m,r&#x3D;(g^e,g^{se}))$ 和新消息-新随机数对 $(m’,r’&#x3D;(g^{e’},g^{se’}))$</p>
</li>
<li><p>计算  $u\leftarrow H(g^s,m)$</p>
</li>
<li><p>如果 $g^eu^m&#x3D;g^{e’}u^{m’}$ 且 $(g, g^s, g^{e’}, g^{se’} )$ 是 Diffie-Hellman tuple，输出1</p>
</li>
</ul>
</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>[1] <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/7PQwD_Q0Knt4nQMnPnbJCw">本体技术视点 | 什么是“变色龙哈希函数”？</a></p>
<p>[2] M. Khalili, M. Dakhilalian, and W. Susilo, “Efficient chameleon hash functions in the enhanced collision resistant model,” <em>Information Sciences</em>, vol. 510, pp. 155–164, Feb. 2020, doi: <a target="_blank" rel="noopener" href="https://doi.org/10.1016/j.ins.2019.09.001">10.1016&#x2F;j.ins.2019.09.001</a>.</p>
<p>[3] J. Zhang <em>et al.</em>, “Serving at the edge: a redactable blockchain with fixed storage,” in <em>International Conference on Web Information Systems and Applications</em>, 2020, pp. 654–667.</p>
<p>[4] M. Jia <em>et al.</em>, “Redactable Blockchain From Decentralized Chameleon Hash Functions,” <em>IEEE Transactions on Information Forensics and Security</em>, vol. 17, pp. 2771–2783, 2022, doi: <a target="_blank" rel="noopener" href="https://doi.org/10.1109/TIFS.2022.3192716">10.1109&#x2F;TIFS.2022.3192716</a>.</p>
</div></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/digital/2022%20%E6%95%B0%E5%AD%97%E7%94%9F%E6%B4%BB/" rel="prev" title="2022 数字生活"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">2022 数字生活</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/essay/AI%EF%BC%9A%E6%A2%A6%E5%A2%83%E6%A1%A3%E6%A1%88/" rel="next" title="《AI：梦境档案 涅槃肇始》"><span class="post-nav-text">《AI：梦境档案 涅槃肇始》</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2022 – 2023 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> 绘素</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></body></html>